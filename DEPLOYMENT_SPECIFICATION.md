# FX Sign Tool - デプロイメント仕様書

## サーバー構成

### 推奨VPS: Contabo Cloud VPS 20
- **プラン**: Cloud VPS 20
- **CPU**: 6vCPU
- **RAM**: 12GB
- **ストレージ**: 100GB NVMe
- **トラフィック**: 32TB/月
- **リージョン**: 東京（アジア）
- **月額料金**: €11.3 (€7.0 + €4.3 東京追加料金)

### OS・ランタイム環境
- **OS**: Ubuntu 24.04 LTS (Noble Numbat)
- **サポート期間**: 2029年4月まで
- **Node.js**: 22.x LTS (Jod)
- **サポート期間**: 2027年4月まで

## ソフトウェア構成

### フロントエンド
```
- React 18.2.0 (TypeScript)
- Ant Design UI Framework
- Canvas API (チャート描画)
- WebSocket (リアルタイム通信)
- Responsive Design対応
```

### バックエンド（推奨構成）
```
- Node.js 22.x LTS
- Express.js (Webサーバー)
- Socket.io (WebSocket)
- PM2 (プロセス管理)
- Nginx (リバースプロキシ)
```

### データベース（推奨）
```
- PostgreSQL 16 (メイン)
- MongoDB 8 (ログ・キャッシュ用)
- Redis (セッション管理)
```

### セキュリティ・SSL
```
- Let's Encrypt SSL証明書
- Nginx SSL設定
- ファイアウォール設定
```

## デプロイメント手順

### 1. サーバー初期設定
```bash
# Ubuntu 24.04 LTS インストール
# SSH設定
# ファイアウォール設定
# セキュリティ更新
```

### 2. Node.js環境構築
```bash
# Node.js 22 LTS インストール
curl -fsSL https://deb.nodesource.com/setup_22.x | sudo -E bash -
sudo apt-get install -y nodejs

# PM2 インストール
npm install -g pm2
```

### 3. Nginx設定
```bash
# Nginx インストール
sudo apt update
sudo apt install nginx

# SSL証明書設定
sudo apt install certbot python3-certbot-nginx
```

### 4. アプリケーションデプロイ
```bash
# リポジトリクローン
# 依存関係インストール
# ビルド実行
# PM2で起動
```

## パフォーマンス要件

### レスポンス時間
- **東京リージョン**: 5-20ms
- **チャート更新**: リアルタイム (WebSocket)
- **TORBロジック計算**: <100ms
- **データベース応答**: <50ms

### 可用性
- **稼働率**: 99.9%以上
- **自動復旧**: PM2による自動再起動
- **バックアップ**: 日次自動バックアップ

## 監視・メンテナンス

### ログ管理
```
- PM2ログ
- Nginxアクセスログ
- アプリケーションログ
- データベースログ
```

### 監視項目
```
- CPU使用率
- メモリ使用率
- ディスク容量
- ネットワーク負荷
- データベース接続数
```

## スケーリング計画

### 段階的拡張
1. **Phase 1**: VPS 20 (現在)
2. **Phase 2**: VPS 30 (ユーザー増加時)
3. **Phase 3**: 複数VPS + ロードバランサー

### アップグレード指標
- **CPU使用率**: 80%以上継続
- **メモリ使用率**: 85%以上継続
- **同時接続数**: 500ユーザー以上

## セキュリティ対策

### 基本セキュリティ
- ファイアウォール設定
- SSH鍵認証
- 定期セキュリティ更新
- 不要ポート閉鎖

### アプリケーションセキュリティ
- HTTPS強制
- CORS設定
- Rate Limiting
- 入力値検証

## バックアップ・復旧

### バックアップ戦略
- **データベース**: 日次自動バックアップ
- **アプリケーション**: Git管理
- **設定ファイル**: 定期保存
- **ログ**: 30日保持

### 復旧手順
1. システム停止
2. バックアップ復元
3. 設定確認
4. サービス再開
5. 動作確認

## コスト概算

### 月額運用費用
- **VPS料金**: €11.3
- **ドメイン料金**: €10-15/年
- **SSL証明書**: €0 (Let's Encrypt)
- **合計**: 約€11.3/月 + ドメイン代

### 年額費用
- **サーバー**: €135.6
- **ドメイン**: €10-15
- **合計**: 約€145-150/年

---

**作成日**: 2025-09-06  
**更新日**: 2025-09-06  
**バージョン**: 1.0

このドキュメントは FX Sign Tool のプロダクションデプロイメントの完全仕様を記載しています。